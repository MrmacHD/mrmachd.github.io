var searchTimer;var revised;$(document).ready(function(){$("#search").css("position","relative");$("#search").append('<div id="search-results"></div>');$("#search-text").keydown(function(a){if(a.which==27){siteSearch($("#search-text").val(""));siteSearch("")}else{if(a.which>=37&&a.which<=40){}else{if(a.which>=16&&a.which<=18){}else{if(a.which==91||a.which==93){}else{if(a.which==9||a.which==20){}else{if(a.which==13){event.preventDefault()}else{if(searchTimer==null){searchTimer=setTimeout("siteSearch($('#search-text').val())",100)}}}}}}}})});siteSearch=function(a){var c;var b=this;b.parseWords=function(d){c=d.toLowerCase().match(/\w{2,}/gi);sWords=new Array();for(w2 in c){stem=stemmer(c[w2]);if($.inArray(stem,sWords)==-1){sWords.push(stem)}}return sWords};b.getIndexUrls=function(d){files=new Object();for(word in d){temp="/search/terms/"+d[word].substring(0,2).toLowerCase()+".json";files[temp]=null}return files};b.loadIndexes=function(d){for(file in d){$.getJSON(file,b.getPostIds)}};b.getPostIds=function(e){if(!b.posts.length){b.posts=new Array()}for(var d in e){if($.inArray(d,b.words)!=-1){for(id in e[d]){if(!b.posts[e[d][id]]){b.posts[e[d][id]]=1}else{b.posts[e[d][id]]++}}}}};b.getPosts=function(){var f=[];for(var d in b.posts){f.push([d,b.posts[d]])}b.posts=f.sort(function(h,g){return g[1]-h[1]});for(var e=0;e<b.posts.length&&e<20;e++){$.get("/search/posts/"+b.posts[e][0]+".html",b.loadPostData)}$(document).unbind()};b.loadPostData=function(e){var f=$(e);if(f.find(".date").length>0){var d=$.timeago(f.find(".date").text())}$("#search-results").removeClass("searching");$("#search-results").css("display","block");$("#search-results").append(f.hide());f.slideDown("slow")};b.clearResults=function(){$(document).unbind();$("#search-results").empty();$("#search-results").hide();$(".form-search i").remove();$(".form-search input").val("")};clearTimeout(searchTimer);searchTimer=null;$(".mainColumn .post").css("display","block");$("div .pagination").css("display","block");$(document).unbind();$(document).ready(function(){$(document).on("click","a[href*=#]",function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var d=$(this.hash);d=d.length&&d||$("[name="+this.hash.slice(1)+"]");if(d.length){var e=d.offset().top;$("html,body").animate({scrollTop:e},300);return false}}})});$("#search-results").empty();$("#search-results").remove("searching");$("#search-results").hide();if($.trim(a)!=""){$("#search-results").addClass("searching");$("#search-results").show();b.posts=new Array();b.words=b.parseWords(a);b.indexUrls=b.getIndexUrls(b.words);b.loadIndexes(b.indexUrls);$(document).ajaxStop(function(){if(b.posts.length){b.getPosts();$("#search-results").css("top",$(".form-search").offset().top+34);$("#search-results").show();$('<i class="icon-remove"></i>').appendTo(".form-search").click(b.clearResults);$(".mainColumn .post").css("display","none");$("div .pagination").css("display","none")}})}};