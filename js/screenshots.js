(function(f){var e=new Array;var c=new Array;var m=new Array;var o=new Array;var d=new Array;var h=new Array;var b=new Array;var g=new Array;var n=new Array;var a=new Array;var l=new Array;f.fn.screenshot=f.fn.ScreenShot=function(p){init=function(q){e[q.id]=f.extend({},f.fn.screenshot.defaults,p);c[q.id]=new Array();m[q.id]=new Array();o[q.id]=new Array();d[q.id]=new Array();h[q.id]=new Array();g[q.id]=0;a[q.id]=0;l[q.id]=1;f.each(f("#"+q.id+" img"),function(r,s){m[q.id][r]=f(s).attr("src");o[q.id][r]=f(s).parent().is("a")?f(s).parent().attr("href"):"";d[q.id][r]=f(s).parent().is("a")?f(s).parent().attr("target"):"";h[q.id][r]=f(s).next().is("span")?f(s).next().html():"";f(s).hide();f(s).next().hide()});f(q).css({"background-image":"url("+m[q.id][0]+")",width:e[q.id].width,height:e[q.id].height,position:"relative","background-position":"top left"}).wrap("<div class='screenshot' id='screenshot-"+q.id+"' />");f.setFields(q);if(e[q.id].navigation){f.setNavigation(q)}f.transition(q,0);f.transitionCall(q)};f.setFields=function(q){tWidth=sWidth=parseInt(e[q.id].width/e[q.id].spw);tHeight=sHeight=parseInt(e[q.id].height/e[q.id].sph);counter=sLeft=sTop=0;tgapx=gapx=e[q.id].width-e[q.id].spw*sWidth;tgapy=gapy=e[q.id].height-e[q.id].sph*sHeight;for(i=1;i<=e[q.id].sph;i++){gapx=tgapx;if(gapy>0){gapy--;sHeight=tHeight+1}else{sHeight=tHeight}for(j=1;j<=e[q.id].spw;j++){if(gapx>0){gapx--;sWidth=tWidth+1}else{sWidth=tWidth}c[q.id][counter]=i+""+j;counter++;if(e[q.id].links){f("#"+q.id).append("<a href='"+o[q.id][0]+"' class='ss-"+q.id+"' id='ss-"+q.id+i+j+"' style='width:"+sWidth+"px; height:"+sHeight+"px; float: left; position: absolute;'></a>")}else{f("#"+q.id).append("<div class='ss-"+q.id+"' id='ss-"+q.id+i+j+"' style='width:"+sWidth+"px; height:"+sHeight+"px; float: left; position: absolute;'></div>")}f("#ss-"+q.id+i+j).css({"background-position":-sLeft+"px "+(-sTop+"px"),left:sLeft,top:sTop});sLeft+=sWidth}sTop+=sHeight;sLeft=0}if(e[q.id].hoverPause){f(".ss-"+q.id).mouseover(function(){e[q.id].pause=true});f(".ss-"+q.id).mouseout(function(){e[q.id].pause=false});f("#ss-title-"+q.id).mouseover(function(){e[q.id].pause=true});f("#ss-title-"+q.id).mouseout(function(){e[q.id].pause=false})}};f.transitionCall=function(q){clearInterval(b[q.id]);delay=e[q.id].delay+e[q.id].spw*e[q.id].sph*e[q.id].sDelay;b[q.id]=setInterval(function(){f.transition(q)},delay)};f.transition=function(q,r){if(e[q.id].pause==true){return}f.effect(q);a[q.id]=0;n[q.id]=setInterval(function(){f.appereance(q,c[q.id][a[q.id]])},e[q.id].sDelay);f(q).css({"background-image":"url("+m[q.id][g[q.id]]+")"});if(typeof(r)=="undefined"){g[q.id]++}else{if(r=="&lt;"){g[q.id]--}else{g[q.id]=r}}if(g[q.id]==m[q.id].length){g[q.id]=0}if(g[q.id]==-1){g[q.id]=m[q.id].length-1}f(".ss-button-"+q.id).removeClass("ss-active");f("#ss-button-"+q.id+"-"+(g[q.id]+1)).addClass("ss-active");if(h[q.id][g[q.id]]){f("#ss-title-"+q.id).css({opacity:0}).animate({opacity:e[q.id].opacity},e[q.id].titleSpeed);f("#ss-title-"+q.id).html(h[q.id][g[q.id]])}else{f("#ss-title-"+q.id).css("opacity",0)}};f.appereance=function(r,q){f(".ss-"+r.id).attr("href",o[r.id][g[r.id]]).attr("target",d[r.id][g[r.id]]);if(a[r.id]==e[r.id].spw*e[r.id].sph){clearInterval(n[r.id]);return}f("#ss-"+r.id+q).css({opacity:0,"background-image":"url("+m[r.id][g[r.id]]+")"});f("#ss-"+r.id+q).animate({opacity:1},300);a[r.id]++};f.setNavigation=function(q){f(q).append("<div id='ss-navigation-"+q.id+"'></div>");f("#ss-navigation-"+q.id).append("<a href='#' id='ss-prev-"+q.id+"' class='ss-prev'>&lt;</a>");f("#ss-navigation-"+q.id).append("<a href='#' id='ss-next-"+q.id+"' class='ss-next'>&gt;</a>");f("#ss-prev-"+q.id).css({position:"absolute",top:e[q.id].height/2-15,left:0,"z-index":5,"line-height":"30px",opacity:e[q.id].opacity}).click(function(r){r.preventDefault();f.transition(q,"&lt;");f.transitionCall(q)}).mouseover(function(){f("#ss-navigation-"+q.id).show()});f("#ss-next-"+q.id).css({position:"absolute",top:e[q.id].height/2-15,right:0,"z-index":5,"line-height":"30px",opacity:e[q.id].opacity}).click(function(r){r.preventDefault();f.transition(q);f.transitionCall(q)}).mouseover(function(){f("#ss-navigation-"+q.id).show()});f("<div id='ss-buttons-"+q.id+"' class='ss-buttons'></div>").appendTo(f("#screenshot-"+q.id));for(k=1;k<m[q.id].length+1;k++){f("#ss-buttons-"+q.id).append("<a href='#' class='ss-button-"+q.id+"' id='ss-button-"+q.id+"-"+k+"'></a>")}f.each(f(".ss-button-"+q.id),function(r,s){f(s).click(function(t){f(".ss-button-"+q.id).removeClass("ss-active");f(this).addClass("ss-active");t.preventDefault();f.transition(q,r);f.transitionCall(q)})});f("#ss-navigation-"+q.id+" a").mouseout(function(){e[q.id].pause=false});f("#ss-buttons-"+q.id).css({left:"50%","margin-left":-m[q.id].length*15/2-5,position:"relative"})};f.effect=function(q){effA=["random","swirl","rain","straight","slide"];if(e[q.id].effect==""){eff=effA[Math.floor(Math.random()*(effA.length))]}else{eff=e[q.id].effect}c[q.id]=new Array();if(eff=="random"){counter=0;for(i=1;i<=e[q.id].sph;i++){for(j=1;j<=e[q.id].spw;j++){c[q.id][counter]=i+""+j;counter++}}f.random(c[q.id])}if(eff=="rain"){f.rain(q)}if(eff=="swirl"){f.swirl(q)}if(eff=="straight"){f.straight(q)}if(eff=="slide"){f.slide(q)}l[q.id]*=-1;if(l[q.id]>0){c[q.id].reverse()}};f.random=function(q){var s=q.length;if(s==0){return false}while(--s){var r=Math.floor(Math.random()*(s+1));var u=q[s];var t=q[r];q[s]=t;q[r]=u}};f.swirl=function(q){var s=e[q.id].sph;var t=e[q.id].spw;var A=1;var z=1;var r=0;var u=0;var w=0;var v=true;while(v){u=(r==0||r==2)?t:s;for(i=1;i<=u;i++){c[q.id][w]=A+""+z;w++;if(i!=u){switch(r){case 0:z++;break;case 1:A++;break;case 2:z--;break;case 3:A--;break}}}r=(r+1)%4;switch(r){case 0:t--;z++;break;case 1:s--;A++;break;case 2:t--;z--;break;case 3:s--;A--;break}check=f.max(s,t)-f.min(s,t);if(t<=check&&s<=check){v=false}}};f.rain=function(s){var v=e[s.id].sph;var q=e[s.id].spw;var u=0;var t=to2=from=1;var r=true;while(r){for(i=from;i<=t;i++){c[s.id][u]=i+""+parseInt(to2-i+1);u++}to2++;if(t<v&&to2<q&&v<q){t++}if(t<v&&v>=q){t++}if(to2>q){from++}if(from>t){r=false}}};f.straight=function(q){counter=0;for(i=1;i<=e[q.id].sph;i++){for(j=1;j<=e[q.id].spw;j++){c[q.id][counter]=i+""+j;counter++}}};f.slide=function(q){counter=0;for(i=1;i<=e[q.id].spw;i++){for(j=1;j<=e[q.id].sph;j++){c[q.id][counter]=j+""+i;counter++}}};f.min=function(r,q){if(r>q){return q}else{return r}};f.max=function(r,q){if(r<q){return q}else{return r}};this.each(function(){init(this)})};f.fn.screenshot.defaults={width:550,height:400,spw:1,sph:1,delay:3000,sDelay:30,opacity:1,titleSpeed:500,effect:"slide",navigation:true,links:false,hoverPause:true}})(jQuery);